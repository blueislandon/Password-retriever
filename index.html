<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Retro Terminal Fetcher</title>
    <style>
        body {
            background-color: #0a0a0a;
            color: #00ff41; /* Classic Matrix/Terminal Green */
            font-family: 'Courier New', Courier, monospace;
            display: flex;
            flex-direction: column;
            align-items: center;
            padding: 50px;
        }

        .terminal-container {
            width: 80%;
            max-width: 800px;
        }

        /* This is your "Text Area" that isn't editable */
        #output-window {
            background-color: #000;
            border: 1px solid #333;
            border-radius: 5px;
            height: 400px;
            padding: 20px;
            overflow-y: auto;
            box-shadow: 0 0 15px rgba(0, 255, 65, 0.2);
            white-space: pre-wrap; /* Maintains formatting/newlines */
            word-wrap: break-word;
        }

        .controls {
            margin-top: 20px;
            display: flex;
            gap: 10px;
        }

        button {
            background: #00ff41;
            color: black;
            border: none;
            padding: 10px 20px;
            font-family: 'Courier New', Courier, monospace;
            font-weight: bold;
            cursor: pointer;
            text-transform: uppercase;
        }

        button:hover {
            background: #00cc33;
        }

        .status {
            color: #888;
            font-size: 0.8rem;
            margin-bottom: 5px;
        }
    </style>
</head>
<body>

    <div class="terminal-container">
        <div class="status">SYSTEM READY... STANDBY FOR DATA</div>
        <div id="output-window">/root/user/data_fetcher >_ </div>
        
        <div class="controls">
            <button onclick="fetchFromSupabase()">Execute Fetch</button>
            <button onclick="clearTerminal()">Clear</button>
        </div>
    </div>

    <script src="https://cdn.jsdelivr.net/npm/@supabase/supabase-js@2"></script>

<script>
    // 1. Setup Supabase Client
    // Renamed 'supabase' to 'supabaseClient' to avoid naming conflicts
    const _supabaseUrl = 'https://fjbldtippwrdxynfwidx.supabase.co';
    const _supabaseKey = 'eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJpc3MiOiJzdXBhYmFzZSIsInJlZiI6ImZqYmxkdGlwcHdyZHh5bmZ3aWR4Iiwicm9sZSI6ImFub24iLCJpYXQiOjE3NzIwNTMyMzIsImV4cCI6MjA4NzYyOTIzMn0.7EQHHbYGSPH1mI6kh-XuyMVWxaPrQ4qw7PIBcy-j8I0';
    
    // Check if the library is loaded and create the client
    const supabaseClient = supabase.createClient(_supabaseUrl, _supabaseKey);

    const output = document.getElementById('output-window');

    async function fetchFromSupabase() {
        logToTerminal("\nInitializing request to Supabase...");

        try {
            // Use the new variable name here
            let { data, error } = await supabaseClient
                .from('passwords')
                .select('*');

            if (error) throw error;

            logToTerminal("Success. Data retrieved:");
            logToTerminal(JSON.stringify(data, null, 2)); 
        } catch (err) {
            logToTerminal("!! ERROR: " + err.message);
            console.error(err);
        }
    }

    function logToTerminal(message) {
        if (!output) return;
        output.innerText += "\n" + message;
        output.scrollTop = output.scrollHeight;
    }

    function clearTerminal() {
        output.innerText = "/root/user/password_retriever >_";
    }
</script>
</body>
</html>
